This is app-independent client stuff.
We should extract this as a utility package in weave to help build app-specific clients without copying so much code.